Cette partie explique comment installer tout le programme de \txl . 
On essaie de faire en sorte qu'aucune connaissance préalable ne soit requise. 

On définit deux grandes étapes. 
La première est l'installation des programmes Python et R qui permettront de faire tourner les programmes de \txl. 
On considère qu'il s'agit de l'environnement de l'ordinateur puisqu'il ne s'agit pas de programmes spécifiques à \txl \ de. On donnera ensuite les indications pour installer les éléments de \txl \ proprement dit.\\

Avant de commencer, précisons que même si on essaie d'être le plus complet possible, il ne faut pas hésiter à utiliser internet en cas de doute (et à mettre à jour ce document).

\section{Environnement de l'ordinateur}

\subsection{Installer Python}

You have to install Python 2.7.x\footnote{ If you wonder why we use Python 2 and not Python 3, you can find some points here: \url{http://wiki.python.org/moin/Python2orPython3}. For \txl, options were limited by the previous choices of \of \ and Liam2.} in the 64 bits versions\footnote{If you're not using a 64-bits version, you may encounter some issues in particular for the \of \ part.}. Installation files can be found on : \url{http://www.python.org/download/releases/}.

Then you need to install all our other dependencies (third-party packages for Python).
If you are on Windows, the easiest way to install them is to use the (unoffical) binary packages from Christoph Gohlke at: \url{http://www.lfd.uci.edu/~gohlke/pythonlibs/}.
If you can't find a package on Gohlke's website, don't panic, there is a solution below.\\

The package linked to the simulation (and Liam2) are : 
\begin{itemize}
\item Numpy
\item PyTables
\item Numexpr
\item PyYAML
\item carray
\end{itemize}

In addition, to run the legislation (\of) : 
\begin{itemize}
\item scipy
\item pandas
\item rpy2
\item PyQt4
\item dateutil
\item distribute
\item openpyxl
\item matplotlib
\item pywin32
\item ipython
\end{itemize}

For some dependencies absent from Gohlke's website, installation can be made after having installed packages \textit{setup\_ tool} and \textit{pip} that can be found on the website. 
Then you can open a command prompt (cmd in windows' search) and just write : pip install package\_ name. \\

Some of these packages are used only for visual interface of \of \ you may don't need. 
So far, distinction has not been made.
Anyway, adding a package is not too costly. \\

Add C:\textbackslash Python27, C:\textbackslash Python27\textbackslash Scripts and C:\textbackslash Python27\textbackslash Lib\textbackslash site-packages\footnote{C:\textbackslash Python27 can be replace by your python directory if you haven't chosen the default installation} is in your system path\footnote{ \label{path} For Windows users, select Properties after a right-click on computer. Then click Advanced system settings > Advanced tab > Environment Variables. Modify Path separating folders by semicolons with no blank.}.
It's going to be usefull later.\\

You're also adviced to install three more dependencies. 
In particular the first one for table visualization.
You're invited to visit easy-to-find corresponding website to install and to use.
\begin{itemize}
\item Vitables : to see tables. It need to be written here but there is a way to open Vitables easily you should definitely find\footnote{So far, I use the viewer.py file which I open with python.exe with a shortcut.}.
\item RunSnakeRun : to be an expert in calculus time used by \txl .
\item Sphinx : to build an write a documentation. For \txl , documentation is done in \LaTeX , but \of \ and Liam2 use it. 
\end{itemize}

And just in case, you should know Cython , used by Liam2, than can build a C extension. 

\subsection{Installer R}
L'installation de R, ne devrait pas poser de problème.
Il faut une version pas trop vieille pour l'utilisation de la librairie rpy2.

Bien sûr, on ne saurait trop recommander l'usage de RStudio, une interface visuelle bien agréable. 

\subsection{Interface Python et R}

Pour que Python et R puisse se parler, il faut modifier le path system comme l'explique la documentation du package rpy2. Trouver comment modifier les variables d'environnement associé à la session. Ajouter deux nouvelles variables (voir note de bas de page \ref{path}: 
\begin{itemize}
\item R\_HOME : Path to your R folder (default is C:\textbackslash Program Files\textbackslash R\textbackslash R-2.15.2).
\item R\_USER : Your name. I must confess I didn't find what it is for.
\end{itemize}

\subsection{Et Aptana, \LaTeX \ ? Et Git ? }

Pour modifier le présent document, vous êtes encouragé à installer \LaTeX \ avec votre éditeur préféré.\\

Sans que cela soit complètement indispensable, pour trouver et installer les fichiers de \txl \ la méthode la plus simple est de se servir de GitHub (\url{https://github.com/}).
On vous recommande de vous inscrire et d'installer l'application. 
Il en sera plus question dans la section suivante.\\

Enfin, en cherchant rapidement sur internet, vous trouverez comment installer Aptana. 
Il s'agit d'un éditeur très très pratique pour Python. 
De plus, il permet d'utiliser les fonctionnalités de Git. 
S'il y a un mode par défaut pour ça, on conseille d'installer Egit\footnote{Dans help\textbackslash Install New Software , ajouter avec le nom de votre choix http://download.eclipse.org/egit/updates puis dans Eclipse Git Team Provider séléctionner  Eclipse Git Team Provider - Source Code } qui, la plupart du temps est mieux apprécié et plus efficace.

\section{Les fichiers de \til}


\subsection{Où installer ?}
Pour l'instant, on recommande de tout installer à la racine du lecteur C: directement. 
A terme, on pourra changer la place des dossiers mais pour l'instant, il faudrait un fichier de configuration qu'il suffirait de remplir pour que les programmes sachent à chaque fois trouver le bon emplacement. \\ 
 
\subsection{Où trouver les sources de \til}
 
Les fichiers de \txl \ se trouve sur GitHub à l'adresse suivante: \url{https://github.com/TaxIPP-Life}.
Les dossiers Til et Til-Liam sont nécessaire, le dossier Til-Doc, qui comme son nom l'indique contient la documentation, ne peut pas faire de mal.
D'ici vous pouver charger un zip ou bien (recommandé) charger ces éléments via GitHub.
Disons en passant, que si vous souhaitez contribuer, d'une manière ou d'une autre au développement de \txl , vous pouvez forker le dossier et user des pull request et des issues.
Si vous ne voulez pas utiliser GitHub, que ce ne soit pas un obstacle à une éventuelle contribution.
Vous pouvez envoyer vos remarques et fichiers à alexis.eidelman@ipp.eu .\\

En fait, les dossier du repository "til" n'est pas suffisant.
Il faudra aussi, installer OpenFisca que l'on peut trouver aussi sur GitHub : \url{https://github.com/openfisca/openfisca}. 

\paragraph{Pourquoi pas un seul dossier ?}
OpenFisca et Liam2 sont des projets dissociés de \txl .
En les mettant dans des dossiers séparés, on peut, surtout quand on utilise GitHub, continuer à faire des mises-à-jour facilement.
On peut aussi faire remonter à ces projets des modifications.
Enfin, c'est une manière de dissocier les différentes parties du modèle.


\subsection{Utilisation d'Aptana}

Le fichier précédemement installé doivent être importer comme projet. 
Clic droit sur la bonne zone puis import ouvre une fenêtre à partir de laquelle l'importation peut s'effectuer. 
Avec Git, on peut choisir import from Git. 
Quelle que soit le mode retenu, il faut choisir la formule PyDev puis PyDev Project. \\

Le chemin des fichiers src d'OpenFisca et src\_ liam de Til-Liam doivent être ajoutés à la liste des dossiers dans lesquels Python cherche pour importer des fichier. 
Pour faire cela, clic-droit sur le dossier Til dans Aptana, puis Properties, Pydev-PYTHONPATH puis ajouter les dossiers dans l'onglet External  Libraries.


\subsection{Associer les extension .yml à notepad++}

Tout est dit, pour plus de lisibilité, on recommande l'utilisation de notepad++ comme cela a été pensé par l'équipe de Liam2. 


\section{Ma première simulation}

De là, les choses sont plutôt simples. Il faut avoir fait tourné run\_all.R dans le fichier Til\textbackslash data\textbackslash Patrimoine (en ayant précisé le chemin de l'enquête patrimoine 2010).
Pour ce premier exemple, il faut mettre non à toutes les options autres que option\_ run au début de ce programme.
En cas d'erreur, vérifier les chemins et l'installation des librairies R préalables (package plyr).
Il faut ensuite ouvrir le fichier  Til\textbackslash pgm\textbackslash run\_ til.py, sous Aptana.
En faisant attention, au chemin et au fait que la ligne "file2h5(fichier)" soit décommentée, faire tourner (raccourci ctrl+F11).
Félicitations, après toutes ces étapes vous venez de faire tourner le modèle \txl \ pour la première fois. 
 